import{c as I}from"./@babel.9e3f1cbd.js";import{s as Pe}from"./set-cookie-parser.cf9053c4.js";import{l as Z}from"./headers-polyfill.7ce5031a.js";import{l as ee}from"./outvariant.5daad0ff.js";import{l as Te}from"./strict-event-emitter.40e95e3a.js";import{l as Re}from"./@open-draft.7980370a.js";import{r as qe}from"./@xmldom.814565ca.js";import{l as Le}from"./web-encoding.135efa2e.js";var Fe={},k={};Object.defineProperty(k,"__esModule",{value:!0});k.IS_PATCHED_MODULE=void 0;k.IS_PATCHED_MODULE=Symbol("isPatchedModule");var W={},Q={exports:{}},se,fe;function Ae(){if(fe)return se;fe=1;var n=1e3,u=n*60,e=u*60,l=e*24,y=l*7,t=l*365.25;se=function(r,a){a=a||{};var m=typeof r;if(m==="string"&&r.length>0)return p(r);if(m==="number"&&isFinite(r))return a.long?d(r):g(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function p(r){if(r=String(r),!(r.length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!a){var m=parseFloat(a[1]),h=(a[2]||"ms").toLowerCase();switch(h){case"years":case"year":case"yrs":case"yr":case"y":return m*t;case"weeks":case"week":case"w":return m*y;case"days":case"day":case"d":return m*l;case"hours":case"hour":case"hrs":case"hr":case"h":return m*e;case"minutes":case"minute":case"mins":case"min":case"m":return m*u;case"seconds":case"second":case"secs":case"sec":case"s":return m*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}function g(r){var a=Math.abs(r);return a>=l?Math.round(r/l)+"d":a>=e?Math.round(r/e)+"h":a>=u?Math.round(r/u)+"m":a>=n?Math.round(r/n)+"s":r+"ms"}function d(r){var a=Math.abs(r);return a>=l?i(r,a,l,"day"):a>=e?i(r,a,e,"hour"):a>=u?i(r,a,u,"minute"):a>=n?i(r,a,n,"second"):r+" ms"}function i(r,a,m,h){var _=a>=m*1.5;return Math.round(r/m)+" "+h+(_?"s":"")}return se}function Me(n){e.debug=e,e.default=e,e.coerce=d,e.disable=t,e.enable=y,e.enabled=p,e.humanize=Ae(),e.destroy=i,Object.keys(n).forEach(r=>{e[r]=n[r]}),e.names=[],e.skips=[],e.formatters={};function u(r){let a=0;for(let m=0;m<r.length;m++)a=(a<<5)-a+r.charCodeAt(m),a|=0;return e.colors[Math.abs(a)%e.colors.length]}e.selectColor=u;function e(r){let a,m=null,h,_;function f(...o){if(!f.enabled)return;const b=f,w=Number(new Date),E=w-(a||w);b.diff=E,b.prev=a,b.curr=w,a=w,o[0]=e.coerce(o[0]),typeof o[0]!="string"&&o.unshift("%O");let c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(s,S)=>{if(s==="%%")return"%";c++;const C=e.formatters[S];if(typeof C=="function"){const x=o[c];s=C.call(b,x),o.splice(c,1),c--}return s}),e.formatArgs.call(b,o),(b.log||e.log).apply(b,o)}return f.namespace=r,f.useColors=e.useColors(),f.color=e.selectColor(r),f.extend=l,f.destroy=e.destroy,Object.defineProperty(f,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(h!==e.namespaces&&(h=e.namespaces,_=e.enabled(r)),_),set:o=>{m=o}}),typeof e.init=="function"&&e.init(f),f}function l(r,a){const m=e(this.namespace+(typeof a>"u"?":":a)+r);return m.log=this.log,m}function y(r){e.save(r),e.namespaces=r,e.names=[],e.skips=[];let a;const m=(typeof r=="string"?r:"").split(/[\s,]+/),h=m.length;for(a=0;a<h;a++)!m[a]||(r=m[a].replace(/\*/g,".*?"),r[0]==="-"?e.skips.push(new RegExp("^"+r.slice(1)+"$")):e.names.push(new RegExp("^"+r+"$")))}function t(){const r=[...e.names.map(g),...e.skips.map(g).map(a=>"-"+a)].join(",");return e.enable(""),r}function p(r){if(r[r.length-1]==="*")return!0;let a,m;for(a=0,m=e.skips.length;a<m;a++)if(e.skips[a].test(r))return!1;for(a=0,m=e.names.length;a<m;a++)if(e.names[a].test(r))return!0;return!1}function g(r){return r.toString().substring(2,r.toString().length-2).replace(/\.\*\?$/,"*")}function d(r){return r instanceof Error?r.stack||r.message:r}function i(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}var je=Me;(function(n,u){u.formatArgs=l,u.save=y,u.load=t,u.useColors=e,u.storage=p(),u.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),u.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function e(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function l(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;d.splice(1,0,i,"color: inherit");let r=0,a=0;d[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(r++,m==="%c"&&(a=r))}),d.splice(a,0,i)}u.log=console.debug||console.log||(()=>{});function y(d){try{d?u.storage.setItem("debug",d):u.storage.removeItem("debug")}catch{}}function t(){let d;try{d=u.storage.getItem("debug")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=process.env.DEBUG),d}function p(){try{return localStorage}catch{}}n.exports=je(u);const{formatters:g}=n.exports;g.j=function(d){try{return JSON.stringify(d)}catch(i){return"[UnexpectedJSONParseError]: "+i.message}}})(Q,Q.exports);var Ee={},j={};Object.defineProperty(j,"__esModule",{value:!0});j.nextTickAsync=j.nextTick=void 0;function He(n){setTimeout(n,0)}j.nextTick=He;function De(n){return new Promise(function(u){setTimeout(function(){u(n())},0)})}j.nextTickAsync=De;(function(n){var u=I&&I.__extends||function(){var a=function(m,h){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,f){_.__proto__=f}||function(_,f){for(var o in f)Object.prototype.hasOwnProperty.call(f,o)&&(_[o]=f[o])},a(m,h)};return function(m,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");a(m,h);function _(){this.constructor=m}m.prototype=h===null?Object.create(h):(_.prototype=h.prototype,new _)}}(),e=I&&I.__awaiter||function(a,m,h,_){function f(o){return o instanceof h?o:new h(function(b){b(o)})}return new(h||(h=Promise))(function(o,b){function w(v){try{c(_.next(v))}catch(s){b(s)}}function E(v){try{c(_.throw(v))}catch(s){b(s)}}function c(v){v.done?o(v.value):f(v.value).then(w,E)}c((_=_.apply(a,m||[])).next())})},l=I&&I.__generator||function(a,m){var h={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},_,f,o,b;return b={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function w(c){return function(v){return E([c,v])}}function E(c){if(_)throw new TypeError("Generator is already executing.");for(;h;)try{if(_=1,f&&(o=c[0]&2?f.return:c[0]?f.throw||((o=f.return)&&o.call(f),0):f.next)&&!(o=o.call(f,c[1])).done)return o;switch(f=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return h.label++,{value:c[1],done:!1};case 5:h.label++,f=c[1],c=[0];continue;case 7:c=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){h=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){h.label=c[1];break}if(c[0]===6&&h.label<o[1]){h.label=o[1],o=c;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(c);break}o[2]&&h.ops.pop(),h.trys.pop();continue}c=m.call(a,h)}catch(v){c=[6,v],f=0}finally{_=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},y=I&&I.__read||function(a,m){var h=typeof Symbol=="function"&&a[Symbol.iterator];if(!h)return a;var _=h.call(a),f,o=[],b;try{for(;(m===void 0||m-- >0)&&!(f=_.next()).done;)o.push(f.value)}catch(w){b={error:w}}finally{try{f&&!f.done&&(h=_.return)&&h.call(_)}finally{if(b)throw b.error}}return o},t=I&&I.__spreadArray||function(a,m){for(var h=0,_=m.length,f=a.length;h<_;h++,f++)a[f]=m[h];return a};Object.defineProperty(n,"__esModule",{value:!0}),n.AsyncEventEmitter=n.AsyncEventEmitterReadyState=void 0;var p=Q.exports,g=Te,d=j,i;(function(a){a.ACTIVE="ACTIVE",a.DEACTIVATED="DEACTIVATED"})(i=n.AsyncEventEmitterReadyState||(n.AsyncEventEmitterReadyState={}));var r=function(a){u(m,a);function m(){var h=a.call(this)||this;return h.log=p.debug("async-event-emitter"),h.queue=new Map,h.readyState=i.ACTIVE,h}return m.prototype.on=function(h,_){var f=this,o=this.log.extend("on");return o('adding "%s" listener...',h),this.readyState===i.DEACTIVATED?(o("the emitter is destroyed, skipping!"),this):a.prototype.on.call(this,h,function(){for(var b=[],w=0;w<arguments.length;w++)b[w]=arguments[w];return e(f,void 0,void 0,function(){var E,c=this;return l(this,function(v){return E=this.openListenerQueue(h),o('awaiting the "%s" listener...',h),E.push({args:b,done:new Promise(function(s,S){return e(c,void 0,void 0,function(){var C;return l(this,function(x){switch(x.label){case 0:return x.trys.push([0,2,,3]),[4,_.apply(void 0,t([],y(b)))];case 1:return x.sent(),s(),o('"%s" listener has resolved!',h),[3,3];case 2:return C=x.sent(),o('"%s" listener has rejected!',C),S(C),[3,3];case 3:return[2]}})})})}),[2]})})})},m.prototype.emit=function(h){for(var _=this,f=[],o=1;o<arguments.length;o++)f[o-1]=arguments[o];var b=this.log.extend("emit");return b('emitting "%s" event...',h),this.readyState===i.DEACTIVATED?(b("the emitter is destroyed, skipping!"),!1):(this.openListenerQueue(h),b('appending a one-time cleanup "%s" listener...',h),this.once(h,function(){d.nextTick(function(){_.queue.delete(h),b('cleaned up "%s" listeners queue!',h)})}),a.prototype.emit.apply(this,t([h],y(f))))},m.prototype.untilIdle=function(h,_){return _===void 0&&(_=function(){return!0}),e(this,void 0,void 0,function(){var f,o=this;return l(this,function(b){switch(b.label){case 0:return f=this.queue.get(h)||[],[4,Promise.all(f.filter(_).map(function(w){var E=w.done;return E})).finally(function(){o.queue.delete(h)})];case 1:return b.sent(),[2]}})})},m.prototype.openListenerQueue=function(h){var _=this.log.extend("openListenerQueue");_('opening "%s" listeners queue...',h);var f=this.queue.get(h);return f?(_("returning an exising queue:",f),f):(_("no queue found, creating one..."),this.queue.set(h,[]),[])},m.prototype.removeAllListeners=function(h){var _=this.log.extend("removeAllListeners");return _("event:",h),h?(this.queue.delete(h),_('cleared the "%s" listeners queue!',h,this.queue.get(h))):(this.queue.clear(),_("cleared the listeners queue!",this.queue)),a.prototype.removeAllListeners.call(this,h)},m.prototype.activate=function(){var h=this.log.extend("activate");this.readyState=i.ACTIVE,h("set state to:",this.readyState)},m.prototype.deactivate=function(){var h=this.log.extend("deactivate");h("removing all listeners..."),this.removeAllListeners(),this.readyState=i.DEACTIVATED,h("set state to:",this.readyState)},m}(g.StrictEventEmitter);n.AsyncEventEmitter=r})(Ee);(function(n){var u=I&&I.__values||function(r){var a=typeof Symbol=="function"&&Symbol.iterator,m=a&&r[a],h=0;if(m)return m.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&h>=r.length&&(r=void 0),{value:r&&r[h++],done:!r}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(n,"__esModule",{value:!0}),n.Interceptor=n.InterceptorReadyState=n.deleteGlobalSymbol=n.getGlobalSymbol=void 0;var e=Q.exports,l=Ee,y=j;function t(r){return globalThis[r]||void 0}n.getGlobalSymbol=t;function p(r,a){globalThis[r]=a}function g(r){delete globalThis[r]}n.deleteGlobalSymbol=g;var d;(function(r){r.IDLE="IDLE",r.APPLYING="APPLYING",r.APPLIED="APPLIED",r.DISPOSING="DISPOSING",r.DISPOSED="DISPOSED"})(d=n.InterceptorReadyState||(n.InterceptorReadyState={}));var i=function(){function r(a){this.symbol=a,this.readyState=d.IDLE,this.emitter=new l.AsyncEventEmitter,this.subscriptions=[],this.log=e.debug(a.description),this.emitter.setMaxListeners(0),this.log("constructing the interceptor...")}return r.prototype.checkEnvironment=function(){return!0},r.prototype.apply=function(){var a=this,m=this.log.extend("apply");if(m("applying the interceptor..."),this.readyState===d.APPLIED){m("intercepted already applied!");return}var h=this.checkEnvironment();if(!h){m("the interceptor cannot be applied in this environment!");return}this.readyState=d.APPLYING,this.emitter.activate(),m("activated the emiter!",this.emitter.readyState);var _=this.getInstance();if(_){m("found a running instance, reusing..."),this.on=function(f,o){m('proxying the "%s" listener',f),_.emitter.addListener(f,o),a.subscriptions.push(function(){_.emitter.removeListener(f,o),m('removed proxied "%s" listener!',f)})},y.nextTick(function(){a.readyState=d.APPLIED});return}m("no running instance found, setting up a new instance..."),this.setup(),this.setInstance(),y.nextTick(function(){a.readyState=d.APPLIED})},r.prototype.setup=function(){},r.prototype.on=function(a,m){var h=this.log.extend("on");if(this.readyState===d.DISPOSING||this.readyState===d.DISPOSED){h("cannot listen to events, already disposed!");return}h('adding "%s" event listener:',a,m.name),this.emitter.on(a,m)},r.prototype.dispose=function(){var a,m,h=this,_=this.log.extend("dispose");if(this.readyState===d.DISPOSED){_("cannot dispose, already disposed!");return}if(_("disposing the interceptor..."),this.readyState=d.DISPOSING,!this.getInstance()){_("no interceptors running, skipping dispose...");return}if(this.clearInstance(),_("global symbol deleted:",t(this.symbol)),this.subscriptions.length>0){_("disposing of %d subscriptions...",this.subscriptions.length);try{for(var f=u(this.subscriptions),o=f.next();!o.done;o=f.next()){var b=o.value;b()}}catch(w){a={error:w}}finally{try{o&&!o.done&&(m=f.return)&&m.call(f)}finally{if(a)throw a.error}}this.subscriptions=[],_("disposed of all subscriptions!",this.subscriptions.length)}this.emitter.deactivate(),_("destroyed the listener!"),y.nextTick(function(){h.readyState=d.DISPOSED})},r.prototype.getInstance=function(){var a,m=t(this.symbol);return this.log("retrieved global instance:",(a=m==null?void 0:m.constructor)===null||a===void 0?void 0:a.name),m},r.prototype.setInstance=function(){p(this.symbol,this),this.log("set global instance!",this.symbol.description)},r.prototype.clearInstance=function(){g(this.symbol),this.log("cleared global instance!",this.symbol.description)},r}();n.Interceptor=i})(W);var te={},ke=I&&I.__extends||function(){var n=function(u,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var t in y)Object.prototype.hasOwnProperty.call(y,t)&&(l[t]=y[t])},n(u,e)};return function(u,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(u,e);function l(){this.constructor=u}u.prototype=e===null?Object.create(e):(l.prototype=e.prototype,new l)}}(),Ue=I&&I.__values||function(n){var u=typeof Symbol=="function"&&Symbol.iterator,e=u&&n[u],l=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&l>=n.length&&(n=void 0),{value:n&&n[l++],done:!n}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(te,"__esModule",{value:!0});te.BatchInterceptor=void 0;var Be=W,Ne=function(n){ke(u,n);function u(e){var l=this;return u.symbol=Symbol(e.name),l=n.call(this,u.symbol)||this,l.interceptors=e.interceptors,l}return u.prototype.setup=function(){var e,l,y=this.log.extend("setup");y("applying all %d interceptors...",this.interceptors.length);var t=function(r){y('applying "%s" interceptor...',r.constructor.name),r.apply(),y("adding interceptor dispose subscription"),p.subscriptions.push(function(){return r.dispose()})},p=this;try{for(var g=Ue(this.interceptors),d=g.next();!d.done;d=g.next()){var i=d.value;t(i)}}catch(r){e={error:r}}finally{try{d&&!d.done&&(l=g.return)&&l.call(g)}finally{if(e)throw e.error}}},u.prototype.on=function(e,l){this.interceptors.forEach(function(y){y.on(e,l)})},u}(Be.Interceptor);te.BatchInterceptor=Ne;var H={},F={};Object.defineProperty(F,"__esModule",{value:!0});F.getArrayBuffer=F.decodeBuffer=F.encodeBuffer=void 0;var Ce=Le;function Xe(n){var u=new Ce.TextEncoder,e=u.encode(n);return Se(e)}F.encodeBuffer=Xe;function Ge(n,u){var e=new Ce.TextDecoder(u);return e.decode(n)}F.decodeBuffer=Ge;function Se(n){return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}F.getArrayBuffer=Se;var re={};Object.defineProperty(re,"__esModule",{value:!0});re.uuidv4=void 0;function $e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var u=Math.random()*16|0,e=n=="x"?u:u&3|8;return e.toString(16)})}re.uuidv4=$e;var ie=I&&I.__awaiter||function(n,u,e,l){function y(t){return t instanceof e?t:new e(function(p){p(t)})}return new(e||(e=Promise))(function(t,p){function g(r){try{i(l.next(r))}catch(a){p(a)}}function d(r){try{i(l.throw(r))}catch(a){p(a)}}function i(r){r.done?t(r.value):y(r.value).then(g,d)}i((l=l.apply(n,u||[])).next())})},ae=I&&I.__generator||function(n,u){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},l,y,t,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(i){return function(r){return d([i,r])}}function d(i){if(l)throw new TypeError("Generator is already executing.");for(;e;)try{if(l=1,y&&(t=i[0]&2?y.return:i[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,i[1])).done)return t;switch(y=0,t&&(i=[i[0]&2,t.value]),i[0]){case 0:case 1:t=i;break;case 4:return e.label++,{value:i[1],done:!1};case 5:e.label++,y=i[1],i=[0];continue;case 7:i=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(i[0]===6||i[0]===2)){e=0;continue}if(i[0]===3&&(!t||i[1]>t[0]&&i[1]<t[3])){e.label=i[1];break}if(i[0]===6&&e.label<t[1]){e.label=t[1],t=i;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(i);break}t[2]&&e.ops.pop(),e.trys.pop();continue}i=u.call(n,e)}catch(r){i=[6,r],y=0}finally{l=t=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(H,"__esModule",{value:!0});H.IsomorphicRequest=void 0;var Ye=Z,ue=ee,de=F,Ve=re,Je=function(){function n(u,e){e===void 0&&(e={});var l=new ArrayBuffer(0);if(this._bodyUsed=!1,u instanceof n){this.id=u.id,this.url=u.url,this.method=u.method,this.headers=u.headers,this.credentials=u.credentials,this._body=u._body||l;return}this.id=Ve.uuidv4(),this.url=u,this.method=e.method||"GET",this.headers=new Ye.Headers(e.headers),this.credentials=e.credentials||"same-origin",this._body=e.body||l}return Object.defineProperty(n.prototype,"bodyUsed",{get:function(){return this._bodyUsed},enumerable:!1,configurable:!0}),n.prototype.text=function(){return ie(this,void 0,void 0,function(){return ae(this,function(u){return ue.invariant(!this.bodyUsed,'Failed to execute "text" on "IsomorphicRequest": body buffer already read'),this._bodyUsed=!0,[2,de.decodeBuffer(this._body)]})})},n.prototype.json=function(){return ie(this,void 0,void 0,function(){var u;return ae(this,function(e){return ue.invariant(!this.bodyUsed,'Failed to execute "json" on "IsomorphicRequest": body buffer already read'),this._bodyUsed=!0,u=de.decodeBuffer(this._body),[2,JSON.parse(u)]})})},n.prototype.arrayBuffer=function(){return ie(this,void 0,void 0,function(){return ae(this,function(u){return ue.invariant(!this.bodyUsed,'Failed to execute "arrayBuffer" on "IsomorphicRequest": body buffer already read'),this._bodyUsed=!0,[2,this._body]})})},n.prototype.clone=function(){return new n(this)},n}();H.IsomorphicRequest=Je;var U={},ne={},ze=I&&I.__awaiter||function(n,u,e,l){function y(t){return t instanceof e?t:new e(function(p){p(t)})}return new(e||(e=Promise))(function(t,p){function g(r){try{i(l.next(r))}catch(a){p(a)}}function d(r){try{i(l.throw(r))}catch(a){p(a)}}function i(r){r.done?t(r.value):y(r.value).then(g,d)}i((l=l.apply(n,u||[])).next())})},Ke=I&&I.__generator||function(n,u){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},l,y,t,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(i){return function(r){return d([i,r])}}function d(i){if(l)throw new TypeError("Generator is already executing.");for(;e;)try{if(l=1,y&&(t=i[0]&2?y.return:i[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,i[1])).done)return t;switch(y=0,t&&(i=[i[0]&2,t.value]),i[0]){case 0:case 1:t=i;break;case 4:return e.label++,{value:i[1],done:!1};case 5:e.label++,y=i[1],i=[0];continue;case 7:i=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(i[0]===6||i[0]===2)){e=0;continue}if(i[0]===3&&(!t||i[1]>t[0]&&i[1]<t[3])){e.label=i[1];break}if(i[0]===6&&e.label<t[1]){e.label=t[1],t=i;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(i);break}t[2]&&e.ops.pop(),e.trys.pop();continue}i=u.call(n,e)}catch(r){i=[6,r],y=0}finally{l=t=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(ne,"__esModule",{value:!0});ne.createLazyCallback=void 0;function We(n){var u=this;n===void 0&&(n={});var e=0,l,y,t=new Promise(function(g){y=g}).finally(function(){clearTimeout(l)}),p=function(){for(var g,d=[],i=0;i<arguments.length;i++)d[i]=arguments[i];n.maxCalls&&e>=n.maxCalls&&((g=n.maxCallsCallback)===null||g===void 0||g.call(n)),y(d),e++};return p.invoked=function(){return ze(u,void 0,void 0,function(){return Ke(this,function(g){return l=setTimeout(function(){y([])},0),[2,t]})})},p}ne.createLazyCallback=We;var Qe=I&&I.__extends||function(){var n=function(u,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var t in y)Object.prototype.hasOwnProperty.call(y,t)&&(l[t]=y[t])},n(u,e)};return function(u,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(u,e);function l(){this.constructor=u}u.prototype=e===null?Object.create(e):(l.prototype=e.prototype,new l)}}();Object.defineProperty(U,"__esModule",{value:!0});U.InteractiveIsomorphicRequest=void 0;var Ze=ee,et=H,tt=ne,rt=function(n){Qe(u,n);function u(e){var l=n.call(this,e)||this;return l.respondWith=tt.createLazyCallback({maxCalls:1,maxCallsCallback:function(){Ze.invariant(!1,'Failed to respond to "%s %s" request: the "request" event has already been responded to.',l.method,l.url.href)}}),l}return u}(et.IsomorphicRequest);U.InteractiveIsomorphicRequest=rt;var oe={};Object.defineProperty(oe,"__esModule",{value:!0});oe.getCleanUrl=void 0;function nt(n,u){return u===void 0&&(u=!0),[u&&n.origin,n.pathname].filter(Boolean).join("")}oe.getCleanUrl=nt;(function(n){var u=I&&I.__createBinding||(Object.create?function(t,p,g,d){d===void 0&&(d=g),Object.defineProperty(t,d,{enumerable:!0,get:function(){return p[g]}})}:function(t,p,g,d){d===void 0&&(d=g),t[d]=p[g]}),e=I&&I.__exportStar||function(t,p){for(var g in t)g!=="default"&&!Object.prototype.hasOwnProperty.call(p,g)&&u(p,t,g)};Object.defineProperty(n,"__esModule",{value:!0}),n.decodeBuffer=n.encodeBuffer=n.getCleanUrl=void 0,e(k,n),e(W,n),e(te,n),e(H,n),e(U,n);var l=oe;Object.defineProperty(n,"getCleanUrl",{enumerable:!0,get:function(){return l.getCleanUrl}});var y=F;Object.defineProperty(n,"encodeBuffer",{enumerable:!0,get:function(){return y.encodeBuffer}}),Object.defineProperty(n,"decodeBuffer",{enumerable:!0,get:function(){return y.decodeBuffer}})})(Fe);var ot={},Ie={};(function(n){var u=I&&I.__rest||function(t,p){var g={};for(var d in t)Object.prototype.hasOwnProperty.call(t,d)&&p.indexOf(d)<0&&(g[d]=t[d]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,d=Object.getOwnPropertySymbols(t);i<d.length;i++)p.indexOf(d[i])<0&&Object.prototype.propertyIsEnumerable.call(t,d[i])&&(g[d[i]]=t[d[i]]);return g};Object.defineProperty(n,"__esModule",{value:!0}),n.store=n.PERSISTENCY_KEY=void 0;const e=Pe.exports;n.PERSISTENCY_KEY="MSW_COOKIE_STORE";function l(){try{if(localStorage==null)return!1;const t=n.PERSISTENCY_KEY+"_test";return localStorage.setItem(t,"test"),localStorage.getItem(t),localStorage.removeItem(t),!0}catch{return!1}}class y{constructor(){this.store=new Map}add(p,g){if(p.credentials==="omit")return;const d=new URL(p.url),i=g.headers.get("set-cookie");if(!i)return;const r=Date.now(),a=e.parse(i).map(h=>{var{maxAge:_}=h,f=u(h,["maxAge"]);return Object.assign(Object.assign({},f),{expires:_===void 0?f.expires:new Date(r+_*1e3),maxAge:_})}),m=this.store.get(d.origin)||new Map;a.forEach(h=>{this.store.set(d.origin,m.set(h.name,h))})}get(p){this.deleteExpiredCookies();const g=new URL(p.url),d=this.store.get(g.origin)||new Map;switch(p.credentials){case"include":return typeof document>"u"||e.parse(document.cookie).forEach(r=>{d.set(r.name,r)}),d;case"same-origin":return d;default:return new Map}}getAll(){return this.deleteExpiredCookies(),this.store}deleteAll(p){const g=new URL(p.url);this.store.delete(g.origin)}clear(){this.store.clear()}hydrate(){if(!l())return;const p=localStorage.getItem(n.PERSISTENCY_KEY);if(!!p)try{JSON.parse(p).forEach(([d,i])=>{this.store.set(d,new Map(i.map(r=>{var[a,m]=r,{expires:h}=m,_=u(m,["expires"]);return[a,h===void 0?_:Object.assign(Object.assign({},_),{expires:new Date(h)})]})))})}catch(g){console.warn(`
[virtual-cookie] Failed to parse a stored cookie from the localStorage (key "${n.PERSISTENCY_KEY}").

Stored value:
${localStorage.getItem(n.PERSISTENCY_KEY)}

Thrown exception:
${g}

Invalid value has been removed from localStorage to prevent subsequent failed parsing attempts.`),localStorage.removeItem(n.PERSISTENCY_KEY)}}persist(){if(!l())return;const p=Array.from(this.store.entries()).map(([g,d])=>[g,Array.from(d.entries())]);localStorage.setItem(n.PERSISTENCY_KEY,JSON.stringify(p))}deleteExpiredCookies(){const p=Date.now();this.store.forEach((g,d)=>{g.forEach(({expires:i,name:r})=>{i!==void 0&&i.getTime()<=p&&g.delete(r)}),g.size===0&&this.store.delete(d)})}}n.store=new y})(Ie);(function(n){var u=I&&I.__createBinding||(Object.create?function(l,y,t,p){p===void 0&&(p=t),Object.defineProperty(l,p,{enumerable:!0,get:function(){return y[t]}})}:function(l,y,t,p){p===void 0&&(p=t),l[p]=y[t]}),e=I&&I.__exportStar||function(l,y){for(var t in l)t!=="default"&&!Object.prototype.hasOwnProperty.call(y,t)&&u(y,l,t)};Object.defineProperty(n,"__esModule",{value:!0}),e(Ie,n)})(ot);var N={},X={},he;function xe(){if(he)return X;he=1,Object.defineProperty(X,"__esModule",{value:!0}),X.toIsoResponse=void 0;var n=Z;function u(e){var l;return{status:(l=e.status)!==null&&l!==void 0?l:200,statusText:e.statusText||"OK",headers:n.objectToHeaders(e.headers||{}),body:e.body}}return X.toIsoResponse=u,X}var pe;function mt(){if(pe)return N;pe=1;var n=I&&I.__extends||function(){var _=function(f,o){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,w){b.__proto__=w}||function(b,w){for(var E in w)Object.prototype.hasOwnProperty.call(w,E)&&(b[E]=w[E])},_(f,o)};return function(f,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");_(f,o);function b(){this.constructor=f}f.prototype=o===null?Object.create(o):(b.prototype=o.prototype,new b)}}(),u=I&&I.__assign||function(){return u=Object.assign||function(_){for(var f,o=1,b=arguments.length;o<b;o++){f=arguments[o];for(var w in f)Object.prototype.hasOwnProperty.call(f,w)&&(_[w]=f[w])}return _},u.apply(this,arguments)},e=I&&I.__awaiter||function(_,f,o,b){function w(E){return E instanceof o?E:new o(function(c){c(E)})}return new(o||(o=Promise))(function(E,c){function v(C){try{S(b.next(C))}catch(x){c(x)}}function s(C){try{S(b.throw(C))}catch(x){c(x)}}function S(C){C.done?E(C.value):w(C.value).then(v,s)}S((b=b.apply(_,f||[])).next())})},l=I&&I.__generator||function(_,f){var o={label:0,sent:function(){if(E[0]&1)throw E[1];return E[1]},trys:[],ops:[]},b,w,E,c;return c={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function v(S){return function(C){return s([S,C])}}function s(S){if(b)throw new TypeError("Generator is already executing.");for(;o;)try{if(b=1,w&&(E=S[0]&2?w.return:S[0]?w.throw||((E=w.return)&&E.call(w),0):w.next)&&!(E=E.call(w,S[1])).done)return E;switch(w=0,E&&(S=[S[0]&2,E.value]),S[0]){case 0:case 1:E=S;break;case 4:return o.label++,{value:S[1],done:!1};case 5:o.label++,w=S[1],S=[0];continue;case 7:S=o.ops.pop(),o.trys.pop();continue;default:if(E=o.trys,!(E=E.length>0&&E[E.length-1])&&(S[0]===6||S[0]===2)){o=0;continue}if(S[0]===3&&(!E||S[1]>E[0]&&S[1]<E[3])){o.label=S[1];break}if(S[0]===6&&o.label<E[1]){o.label=E[1],E=S;break}if(E&&o.label<E[2]){o.label=E[2],o.ops.push(S);break}E[2]&&o.ops.pop(),o.trys.pop();continue}S=f.call(_,o)}catch(C){S=[6,C],w=0}finally{b=E=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},y=I&&I.__read||function(_,f){var o=typeof Symbol=="function"&&_[Symbol.iterator];if(!o)return _;var b=o.call(_),w,E=[],c;try{for(;(f===void 0||f-- >0)&&!(w=b.next()).done;)E.push(w.value)}catch(v){c={error:v}}finally{try{w&&!w.done&&(o=b.return)&&o.call(b)}finally{if(c)throw c.error}}return E};Object.defineProperty(N,"__esModule",{value:!0}),N.FetchInterceptor=void 0;var t=Z,p=ee,g=H,d=k,i=W,r=xe(),a=U,m=function(_){n(f,_);function f(){return _.call(this,f.symbol)||this}return f.prototype.checkEnvironment=function(){return typeof globalThis<"u"&&typeof globalThis.fetch<"u"},f.prototype.setup=function(){var o=this,b=globalThis.fetch;p.invariant(!b[d.IS_PATCHED_MODULE],'Failed to patch the "fetch" module: already patched.'),globalThis.fetch=function(w,E){return e(o,void 0,void 0,function(){var c,v,s,S,C,x,P,O,R,L,D=this;return l(this,function(A){switch(A.label){case 0:return c=new Request(w,E),v=typeof w=="string"?w:w.url,s=c.method,this.log("[%s] %s",s,v),[4,c.clone().arrayBuffer()];case 1:return S=A.sent(),C=new g.IsomorphicRequest(new URL(v,location.origin),{body:S,method:s,headers:new t.Headers(c.headers),credentials:c.credentials}),x=new a.InteractiveIsomorphicRequest(C),this.log("isomorphic request",x),this.log('emitting the "request" event for %d listener(s)...',this.emitter.listenerCount("request")),this.emitter.emit("request",x),this.log("awaiting for the mocked response..."),[4,this.emitter.untilIdle("request",function(q){var M=y(q.args,1),T=M[0];return T.id===x.id})];case 2:return A.sent(),this.log("all request listeners have been resolved!"),[4,x.respondWith.invoked()];case 3:return P=y.apply(void 0,[A.sent(),1]),O=P[0],this.log("event.respondWith called with:",O),O?(this.log("received mocked response:",O),R=r.toIsoResponse(O),this.log("derived isomorphic response:",R),this.emitter.emit("response",x,R),L=new Response(O.body,u(u({},R),{headers:t.flattenHeadersObject(O.headers||{})})),Object.defineProperty(L,"url",{writable:!1,enumerable:!0,configurable:!1,value:x.url.href}),[2,L]):(this.log("no mocked response received!"),[2,b(c).then(function(q){return e(D,void 0,void 0,function(){var M,T,B,le;return l(this,function(ce){switch(ce.label){case 0:return M=q.clone(),this.log("original fetch performed",M),B=(T=this.emitter).emit,le=["response",x],[4,h(M)];case 1:return B.apply(T,le.concat([ce.sent()])),[2,q]}})})})])}})})},Object.defineProperty(globalThis.fetch,d.IS_PATCHED_MODULE,{enumerable:!0,configurable:!0,value:!0}),this.subscriptions.push(function(){Object.defineProperty(globalThis.fetch,d.IS_PATCHED_MODULE,{value:void 0}),globalThis.fetch=b,o.log('restored native "globalThis.fetch"!',globalThis.fetch.name)})},f.symbol=Symbol("fetch"),f}(i.Interceptor);N.FetchInterceptor=m;function h(_){return e(this,void 0,void 0,function(){var f;return l(this,function(o){switch(o.label){case 0:return f={status:_.status,statusText:_.statusText,headers:t.objectToHeaders(t.headersToObject(_.headers))},[4,_.text()];case 1:return[2,(f.body=o.sent(),f)]}})})}return N}var G={},$={},Y={},ve;function st(){if(ve)return Y;ve=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.parseJson=void 0;function n(u){try{var e=JSON.parse(u);return e}catch{return null}}return Y.parseJson=n,Y}var V={},ye;function it(){if(ye)return V;ye=1,Object.defineProperty(V,"__esModule",{value:!0}),V.bufferFrom=void 0;function n(u){var e=encodeURIComponent(u),l=e.replace(/%([0-9A-F]{2})/g,function(t,p){return String.fromCharCode("0x"+p)}),y=new Uint8Array(l.length);return Array.prototype.forEach.call(l,function(t,p){y[p]=t.charCodeAt(0)}),y}return V.bufferFrom=n,V}var J={},z={},ge;function Oe(){if(ge)return z;ge=1,Object.defineProperty(z,"__esModule",{value:!0}),z.EventPolyfill=void 0;var n=function(){function u(e,l){this.AT_TARGET=0,this.BUBBLING_PHASE=0,this.CAPTURING_PHASE=0,this.NONE=0,this.type="",this.srcElement=null,this.currentTarget=null,this.eventPhase=0,this.isTrusted=!0,this.composed=!1,this.cancelable=!0,this.defaultPrevented=!1,this.bubbles=!0,this.lengthComputable=!0,this.loaded=0,this.total=0,this.cancelBubble=!1,this.returnValue=!0,this.type=e,this.target=(l==null?void 0:l.target)||null,this.currentTarget=(l==null?void 0:l.currentTarget)||null,this.timeStamp=Date.now()}return u.prototype.composedPath=function(){return[]},u.prototype.initEvent=function(e,l,y){this.type=e,this.bubbles=!!l,this.cancelable=!!y},u.prototype.preventDefault=function(){this.defaultPrevented=!0},u.prototype.stopPropagation=function(){},u.prototype.stopImmediatePropagation=function(){},u}();return z.EventPolyfill=n,z}var K={},me;function at(){if(me)return K;me=1;var n=I&&I.__extends||function(){var l=function(y,t){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var d in g)Object.prototype.hasOwnProperty.call(g,d)&&(p[d]=g[d])},l(y,t)};return function(y,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");l(y,t);function p(){this.constructor=y}y.prototype=t===null?Object.create(t):(p.prototype=t.prototype,new p)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.ProgressEventPolyfill=void 0;var u=Oe(),e=function(l){n(y,l);function y(t,p){var g=l.call(this,t)||this;return g.lengthComputable=(p==null?void 0:p.lengthComputable)||!1,g.composed=(p==null?void 0:p.composed)||!1,g.loaded=(p==null?void 0:p.loaded)||0,g.total=(p==null?void 0:p.total)||0,g}return y}(u.EventPolyfill);return K.ProgressEventPolyfill=e,K}var be;function ut(){if(be)return J;be=1,Object.defineProperty(J,"__esModule",{value:!0}),J.createEvent=void 0;var n=Oe(),u=at(),e=typeof ProgressEvent<"u";function l(y,t,p){var g=["error","progress","loadstart","loadend","load","timeout","abort"],d=e?ProgressEvent:u.ProgressEventPolyfill,i=g.includes(t)?new d(t,{lengthComputable:!0,loaded:(p==null?void 0:p.loaded)||0,total:(p==null?void 0:p.total)||0}):new n.EventPolyfill(t,{target:y,currentTarget:y});return i}return J.createEvent=l,J}var _e;function lt(){if(_e)return $;_e=1;var n=I&&I.__awaiter||function(f,o,b,w){function E(c){return c instanceof b?c:new b(function(v){v(c)})}return new(b||(b=Promise))(function(c,v){function s(x){try{C(w.next(x))}catch(P){v(P)}}function S(x){try{C(w.throw(x))}catch(P){v(P)}}function C(x){x.done?c(x.value):E(x.value).then(s,S)}C((w=w.apply(f,o||[])).next())})},u=I&&I.__generator||function(f,o){var b={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},w,E,c,v;return v={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function s(C){return function(x){return S([C,x])}}function S(C){if(w)throw new TypeError("Generator is already executing.");for(;b;)try{if(w=1,E&&(c=C[0]&2?E.return:C[0]?E.throw||((c=E.return)&&c.call(E),0):E.next)&&!(c=c.call(E,C[1])).done)return c;switch(E=0,c&&(C=[C[0]&2,c.value]),C[0]){case 0:case 1:c=C;break;case 4:return b.label++,{value:C[1],done:!1};case 5:b.label++,E=C[1],C=[0];continue;case 7:C=b.ops.pop(),b.trys.pop();continue;default:if(c=b.trys,!(c=c.length>0&&c[c.length-1])&&(C[0]===6||C[0]===2)){b=0;continue}if(C[0]===3&&(!c||C[1]>c[0]&&C[1]<c[3])){b.label=C[1];break}if(C[0]===6&&b.label<c[1]){b.label=c[1],c=C;break}if(c&&b.label<c[2]){b.label=c[2],b.ops.push(C);break}c[2]&&b.ops.pop(),b.trys.pop();continue}C=o.call(f,b)}catch(x){C=[6,x],E=0}finally{w=c=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},e=I&&I.__values||function(f){var o=typeof Symbol=="function"&&Symbol.iterator,b=o&&f[o],w=0;if(b)return b.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&w>=f.length&&(f=void 0),{value:f&&f[w++],done:!f}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},l=I&&I.__read||function(f,o){var b=typeof Symbol=="function"&&f[Symbol.iterator];if(!b)return f;var w=b.call(f),E,c=[],v;try{for(;(o===void 0||o-- >0)&&!(E=w.next()).done;)c.push(E.value)}catch(s){v={error:s}}finally{try{E&&!E.done&&(b=w.return)&&b.call(w)}finally{if(v)throw v.error}}return c};Object.defineProperty($,"__esModule",{value:!0}),$.createXMLHttpRequestOverride=void 0;var y=Re,t=Z,p=qe(),g=st(),d=xe(),i=it(),r=ut(),a=H,m=F,h=U,_=function(f){var o,b=f.XMLHttpRequest,w=f.emitter,E=f.log;return o=function(){function c(){this._events=[],this.log=E,this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.onreadystatechange=null,this.onabort=null,this.onerror=null,this.onload=null,this.onloadend=null,this.onloadstart=null,this.onprogress=null,this.ontimeout=null,this.url="",this.method="GET",this.readyState=this.UNSENT,this.withCredentials=!1,this.status=200,this.statusText="OK",this.response="",this.responseType="text",this.responseText="",this.responseXML=null,this.responseURL="",this.upload={},this.timeout=0,this._requestHeaders=new t.Headers,this._responseHeaders=new t.Headers}return c.prototype.setReadyState=function(v){v!==this.readyState&&(this.log("readyState change %d -> %d",this.readyState,v),this.readyState=v,v!==this.UNSENT&&(this.log("triggering readystate change..."),this.trigger("readystatechange")))},c.prototype.trigger=function(v,s){var S,C;this.log('trigger "%s" (%d)',v,this.readyState),this.log('resolve listener for event "%s"',v);var x=this["on"+v];x==null||x.call(this,r.createEvent(this,v,s));try{for(var P=e(this._events),O=P.next();!O.done;O=P.next()){var R=O.value;R.name===v&&(E('calling mock event listener "%s" (%d)',v,this.readyState),R.listener.call(this,r.createEvent(this,v,s)))}}catch(L){S={error:L}}finally{try{O&&!O.done&&(C=P.return)&&C.call(P)}finally{if(S)throw S.error}}return this},c.prototype.reset=function(){this.log("reset"),this.setReadyState(this.UNSENT),this.status=200,this.statusText="OK",this.response=null,this.responseText=null,this.responseXML=null,this._requestHeaders=new t.Headers,this._responseHeaders=new t.Headers},c.prototype.open=function(v,s,S,C,x){return S===void 0&&(S=!0),n(this,void 0,void 0,function(){return u(this,function(P){return this.log=this.log.extend("request "+v+" "+s),this.log("open",{method:v,url:s,async:S,user:C,password:x}),this.reset(),this.setReadyState(this.OPENED),typeof s>"u"?(this.url=v,this.method="GET"):(this.url=s,this.method=v,this.async=S,this.user=C,this.password=x),[2]})})},c.prototype.send=function(v){var s=this;this.log("send %s %s",this.method,this.url);var S;typeof v=="string"?S=m.encodeBuffer(v):S=v||new ArrayBuffer(0);var C;try{C=new URL(this.url)}catch{C=new URL(this.url,window.location.href)}this.log("request headers",this._requestHeaders);var x=new a.IsomorphicRequest(C,{body:S,method:this.method,headers:this._requestHeaders,credentials:this.withCredentials?"include":"omit"}),P=new h.InteractiveIsomorphicRequest(x);this.log('emitting the "request" event for %d listener(s)...',w.listenerCount("request")),w.emit("request",P),this.log("awaiting mocked response..."),Promise.resolve(y.until(function(){return n(s,void 0,void 0,function(){var O,R;return u(this,function(L){switch(L.label){case 0:return[4,w.untilIdle("request",function(D){var A=l(D.args,1),q=A[0];return q.id===P.id})];case 1:return L.sent(),this.log("all request listeners have been resolved!"),[4,P.respondWith.invoked()];case 2:return O=l.apply(void 0,[L.sent(),1]),R=O[0],this.log("event.respondWith called with:",R),[2,R]}})})})).then(function(O){var R,L,D=l(O,2),A=D[0],q=D[1];if(A){s.log("middleware function threw an exception!",A),s.trigger("error"),s.abort();return}if(q){if(s.log("received mocked response",q),s.trigger("loadstart"),s.status=(R=q.status)!==null&&R!==void 0?R:200,s.statusText=q.statusText||"OK",s._responseHeaders=q.headers?t.objectToHeaders(q.headers):new t.Headers,s.log("set response status",s.status,s.statusText),s.log("set response headers",s._responseHeaders),s.setReadyState(s.HEADERS_RECEIVED),s.log("response type",s.responseType),s.response=s.getResponseBody(q.body),s.responseURL=s.url,s.responseText=q.body||"",s.responseXML=s.getResponseXML(),s.log("set response body",s.response),q.body&&s.response){s.setReadyState(s.LOADING);var M=i.bufferFrom(q.body);s.trigger("progress",{loaded:M.length,total:M.length})}s.setReadyState(s.DONE),s.trigger("load"),s.trigger("loadend"),w.emit("response",x,d.toIsoResponse(q))}else{s.log("no mocked response received!");var T=new b;s.log("opening an original request %s %s",s.method,s.url),T.open(s.method,s.url,(L=s.async)!==null&&L!==void 0?L:!0,s.user,s.password),T.addEventListener("load",function(){s.log('original "onload"'),s.status=T.status,s.statusText=T.statusText,s.responseURL=T.responseURL,s.responseType=T.responseType,s.response=T.response,s.responseText=T.responseText,s.responseXML=T.responseXML,s.log("set mock request readyState to DONE"),s.setReadyState(s.DONE),s.log("received original response",s.status,s.statusText),s.log("original response body:",s.response);var B=T.getAllResponseHeaders();s.log(`original response headers:
`,B),s._responseHeaders=t.stringToHeaders(B),s.log("original response headers (normalized)",s._responseHeaders),s.log("original response finished"),w.emit("response",x,{status:T.status,statusText:T.statusText,headers:s._responseHeaders,body:T.response})}),s.propagateCallbacks(T),s.propagateListeners(T),s.propagateHeaders(T,s._requestHeaders),s.async&&(T.timeout=s.timeout),s.log("send",v),T.send(v)}})},c.prototype.abort=function(){this.log("abort"),this.readyState>this.UNSENT&&this.readyState<this.DONE&&(this.setReadyState(this.UNSENT),this.trigger("abort"))},c.prototype.dispatchEvent=function(){return!1},c.prototype.setRequestHeader=function(v,s){this.log('set request header "%s" to "%s"',v,s),this._requestHeaders.append(v,s)},c.prototype.getResponseHeader=function(v){if(this.log('get response header "%s"',v),this.readyState<this.HEADERS_RECEIVED)return this.log("cannot return a header: headers not received (state: %s)",this.readyState),null;var s=this._responseHeaders.get(v);return this.log('resolved response header "%s" to "%s"',v,s,this._responseHeaders),s},c.prototype.getAllResponseHeaders=function(){return this.log("get all response headers"),this.readyState<this.HEADERS_RECEIVED?(this.log("cannot return headers: headers not received (state: %s)",this.readyState),""):t.headersToString(this._responseHeaders)},c.prototype.addEventListener=function(v,s){this.log("addEventListener",v,s),this._events.push({name:v,listener:s})},c.prototype.removeEventListener=function(v,s){this.log("removeEventListener",v,s),this._events=this._events.filter(function(S){return S.name!==v&&S.listener!==s})},c.prototype.overrideMimeType=function(){},c.prototype.getResponseBody=function(v){var s=v!=null?v:"";switch(this.log("coerced response body to",s),this.responseType){case"json":return this.log("resolving response body as JSON"),g.parseJson(s);case"blob":{var S=this.getResponseHeader("content-type")||"text/plain";return this.log("resolving response body as Blob",{type:S}),new Blob([s],{type:S})}case"arraybuffer":{this.log("resolving response body as ArrayBuffer");var C=i.bufferFrom(s);return C}default:return s}},c.prototype.getResponseXML=function(){var v=this.getResponseHeader("Content-Type");return v==="application/xml"||v==="text/xml"?new p.DOMParser().parseFromString(this.responseText,v):null},c.prototype.propagateCallbacks=function(v){var s,S;this.log("propagating request callbacks to the original request");var C=["abort","onerror","ontimeout","onload","onloadstart","onloadend","onprogress","onreadystatechange"];try{for(var x=e(C),P=x.next();!P.done;P=x.next()){var O=P.value,R=this[O];R&&(v[O]=this[O],this.log('propagated the "%s" callback',O,R))}}catch(L){s={error:L}}finally{try{P&&!P.done&&(S=x.return)&&S.call(x)}finally{if(s)throw s.error}}v.onabort=this.abort,v.onerror=this.onerror,v.ontimeout=this.ontimeout,v.onload=this.onload,v.onloadstart=this.onloadstart,v.onloadend=this.onloadend,v.onprogress=this.onprogress,v.onreadystatechange=this.onreadystatechange},c.prototype.propagateListeners=function(v){this.log("propagating request listeners (%d) to the original request",this._events.length,this._events),this._events.forEach(function(s){var S=s.name,C=s.listener;v.addEventListener(S,C)})},c.prototype.propagateHeaders=function(v,s){var S=this;this.log("propagating request headers to the original request",s),Object.entries(s.raw()).forEach(function(C){var x=l(C,2),P=x[0],O=x[1];S.log('setting "%s" (%s) header on the original request',P,O),v.setRequestHeader(P,O)})},c}(),o.UNSENT=0,o.OPENED=1,o.HEADERS_RECEIVED=2,o.LOADING=3,o.DONE=4,o};return $.createXMLHttpRequestOverride=_,$}var we;function bt(){if(we)return G;we=1;var n=I&&I.__extends||function(){var p=function(g,d){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},p(g,d)};return function(g,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");p(g,d);function i(){this.constructor=g}g.prototype=d===null?Object.create(d):(i.prototype=d.prototype,new i)}}();Object.defineProperty(G,"__esModule",{value:!0}),G.XMLHttpRequestInterceptor=void 0;var u=ee,e=k,l=W,y=lt(),t=function(p){n(g,p);function g(){return p.call(this,g.symbol)||this}return g.prototype.checkEnvironment=function(){return typeof window<"u"&&typeof window.XMLHttpRequest<"u"},g.prototype.setup=function(){var d=this.log.extend("setup");d('patching "XMLHttpRequest" module...');var i=window.XMLHttpRequest;u.invariant(!i[e.IS_PATCHED_MODULE],'Failed to patch the "XMLHttpRequest" module: already patched.'),window.XMLHttpRequest=y.createXMLHttpRequestOverride({XMLHttpRequest:i,emitter:this.emitter,log:this.log}),d('native "XMLHttpRequest" module patched!',window.XMLHttpRequest.name),Object.defineProperty(window.XMLHttpRequest,e.IS_PATCHED_MODULE,{enumerable:!0,configurable:!0,value:!0}),this.subscriptions.push(function(){Object.defineProperty(window.XMLHttpRequest,e.IS_PATCHED_MODULE,{value:void 0}),window.XMLHttpRequest=i,d('native "XMLHttpRequest" module restored!',window.XMLHttpRequest.name)})},g.symbol=Symbol("xhr"),g}(l.Interceptor);return G.XMLHttpRequestInterceptor=t,G}export{bt as a,Fe as b,F as c,oe as g,ot as l,mt as r};
